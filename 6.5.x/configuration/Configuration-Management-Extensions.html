<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="CAS - Enterprise Single Sign-On for the Web"/>
    <meta name="keywords" content="authentication, login, cas, central authentication service, web, java, protocol, thymeleaf,
                   open source, boot, spring, authorization, google, facebook, twitter, higher-ed, enterprise,
                   access management, single signon, sso, RBAC, ABAC, attributes, SAML, OpenID, openid connect,
                   JWT, ADFS"/>
    <meta name="robots" content="index,follow"/>

    
    

        
    


    

    <script>
        ((i, s, o, g, r, a, m) => {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-83384532-2', 'auto');
        ga('send', 'pageview');

    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>

    <link rel="stylesheet" type="text/css" media="screen" href="../../stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="print" href="../../stylesheets/print.css">

    <link href='https://fonts.googleapis.com/css?family=Lato:400,300,700' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&subset=latin-ext,latin' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet">

    <title>CAS - Configuration Extensions</title>

</head>

<body>
<!-- HEADER -->
<header class="hidden-sm-down">
    <div class="container">
        <div class="row">
            <div class="col-xs-4 col-md-2">
                <a href="../../index.html">
                    <img class="undecorated" src="../../images/cas_logo.png"/>
                </a>
            </div>
            <div class="col-xs-8 col-md-6">
                <h1>Enterprise Single Sign-On for All</h1>
            </div>
            <div class="hidden-sm-down col-md-4">
                <a id="forkme_banner" href="https://github.com/apereo/cas">View on GitHub</a>
            </div>

        </div>
    </div>
</header>

<!-- NAVBAR -->

<nav class="navbar navbar-expand-md navbar-dark bg-primary bg-dark">
    <div class="container">
        <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse collapse" id="navbarsExample04">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active"><a href="../../index.html" class="zoom nav-link">Home</a></li>
                <li class="nav-item"><a href="https://github.com/apereo/cas/releases" class="zoom nav-link">Releases</a></li>
                <li class="nav-item"><a href="../../Support.html" class="zoom nav-link">Support</a></li>
                <li class="nav-item"><a href="../../Mailing-Lists.html" class="zoom nav-link">Mailing Lists</a></li>
                <li class="nav-item">
                    <a class="zoom nav-link" href="../../Demos.html">Demos</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="zoom nav-link dropdown-toggle mr-md-2" href="#" id="cas-versions" data-bs-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">Versions</a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="cas-versions">
                        
                        
                        <a class="dropdown-item" href="/cas/development/">Development</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.6.x/">v6.6.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.5.x/">v6.5.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.4.x/">v6.4.x</a>
                        
                        

                    </div>
                </li>
                <li class="nav-item"><a href="https://apereo.github.io" target="_blank" class="zoom nav-link">Blog</a></li>
            </ul>

        </div>

    </div>
</nav>


<div class="container-fluid">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 docs-sidebar pb-5" id="sidebar"></div>


        <div class="d-none d-xl-block col-xl-2 docs-toc">
    <div id="pageContents">
        <ul class="section-nav"></ul>
    </div>
</div>


        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 cas-docs-content" role="main">


            

            <section>
                <nav id="docsNavBar">
                    <span id="toolbarIcons"></span>
                </nav>

                <div id="cas-docs-container">
                    
<h1 id="extending-cas-configuration">Extending CAS Configuration</h1>

<p>Being a <a href="https://github.com/spring-projects/spring-boot">Spring Boot</a> application at its core, designing and extending CAS configuration components 
very much comes down to <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/">the following guide</a> some aspects 
of which are briefly highlighted in this document.</p>

<h2 id="configuration-components">Configuration Components</h2>

<p>This is the recommended approach to create additional Spring beans, override existing ones and inject your own 
custom behavior into the CAS application runtime.</p>

<p>Given CASâ€™ adoption of Spring Boot, most if not all of the old XML configuration is transformed into <code class="language-plaintext highlighter-rouge">@Configuration</code> 
components. These are classes declared by each relevant module that are automatically picked up at runtime whose job 
is to declare and configure beans and register them into the application context. Another way of thinking about it 
is, components that are decorated with <code class="language-plaintext highlighter-rouge">@Configuration</code> are loose equivalents of old XML configuration files that 
are highly organized where <code class="language-plaintext highlighter-rouge">&lt;bean&gt;</code> tags are translated to java methods tagged with <code class="language-plaintext highlighter-rouge">@Bean</code> and configured dynamically.</p>

<h3 id="design">Design</h3>

<p>To design your own configuration class, take inspiration from the following sample:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">org.apereo.cas.custom.config</span><span class="o">;</span>

<span class="nd">@Configuration</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"SomethingConfiguration"</span><span class="o">,</span> <span class="n">proxyBeanMethods</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
<span class="nd">@EnableConfigurationProperties</span><span class="o">(</span><span class="nc">CasConfigurationProperties</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SomethingConfiguration</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">CasConfigurationProperties</span> <span class="n">casProperties</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"someOtherBeanId"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">SomeBean</span> <span class="n">someOtherBeanId</span><span class="o">;</span>

    <span class="nd">@RefreshScope</span><span class="o">(</span><span class="n">proxyMode</span> <span class="o">=</span> <span class="nc">ScopedProxyMode</span><span class="o">.</span><span class="na">DEFAULT</span><span class="o">)</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">MyBean</span> <span class="nf">myBean</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">MyBean</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span> 
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">@Bean</code> definitions can also be tagged with <code class="language-plaintext highlighter-rouge">@RefreshScope(proxyMode = ScopedProxyMode.DEFAULT)</code> to become auto-reloadable when the CAS 
context is refreshed as a result of an external property change.</li>
  <li><code class="language-plaintext highlighter-rouge">@Configuration</code> classes can be assigned an order with <code class="language-plaintext highlighter-rouge">@Order(1984)</code> which would place 
them in an ordered queue waiting to be loaded in that sequence.</li>
  <li>To be more explicit, <code class="language-plaintext highlighter-rouge">@Configuration</code> classes can also be loaded exactly before/after 
another <code class="language-plaintext highlighter-rouge">@Configuration</code> component with <code class="language-plaintext highlighter-rouge">@AutoConfigureBefore</code> or <code class="language-plaintext highlighter-rouge">@AutoConfigureAfter</code> annotations.</li>
</ul>

<div class="alert alert-info"><strong>To Build &amp; Beyond</strong><p>Note that compiling configuration classes and any other
piece of Java code that is put into the CAS Overlay may require additional CAS modules and dependencies on the classpath. You will need
to study the CAS codebase and find the correct modules that contain the components you need, such 
as <code>CasConfigurationProperties</code> and others.</p></div>

<h3 id="register">Register</h3>

<p>How are <code class="language-plaintext highlighter-rouge">@Configuration</code> components picked up? Each CAS module declares its set of configuration components as such, 
per guidelines <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/">laid out by Spring Boot</a>:</p>

<ul>
  <li>Create a <code class="language-plaintext highlighter-rouge">src/main/resources/META-INF/spring.factories</code> file</li>
  <li>Add the following into the file:</li>
</ul>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="py">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span><span class="p">=</span><span class="s">org.apereo.cas.custom.config.SomethingConfiguration</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="overrides">Overrides</h3>

<p>What if you needed to override the definition of a CAS-provided bean and replace it entirely with your own?</p>

<p>This is where <code class="language-plaintext highlighter-rouge">@Conditional</code> components come to aid. Most component/bean definitions in CAS are registered 
with some form of <code class="language-plaintext highlighter-rouge">@Conditional</code> tag that indicates to the bootstrapping process to ignore their 
creation, if <em>a bean definition with the same id</em> is already defined. This means you can create 
your own configuration class, register it and the design a <code class="language-plaintext highlighter-rouge">@Bean</code> definition only to have the 
context utilize yours rather than what ships with CAS by default.</p>

<div class="alert alert-info"><strong>Bean Names</strong><p>To correctly define a conditional <code>Bean</code>, 
you generally need to make sure your own bean definition is created using the same name or identifier as its original equivalent. 
It is impractical and certainly overwheling to document all runtime bean definitions and their identifiers. So, you will
need to study the CAS codebase to find the correct configuration classes and bean defnitions to note their name.</p></div>

<h3 id="exclusions">Exclusions</h3>

<p>You can control the list of auto-configuration classes to exclude them in the <code class="language-plaintext highlighter-rouge">cas.properties</code> file:</p>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="py">spring.autoconfigure.exclude</span><span class="p">=</span><span class="s">org.apereo.cas.custom.config.SomethingConfiguration</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="cas-properties">CAS Properties</h2>

<p>The collection of CAS-provided settings are all encapsulated 
inside a <code class="language-plaintext highlighter-rouge">CasConfigurationProperties</code> component. This is a parent class that brings all elements of the 
entire CAS platform together and binds values to the relevant fields inside in a 
very type-safe manner. The <a href="Configuration-Server-Management.html">configuration binding</a> is 
typically done via <code class="language-plaintext highlighter-rouge">@EnableConfigurationProperties(CasConfigurationProperties.class)</code> on the actual configuration class.</p>

<div class="alert alert-info"><strong>Prefix Notation</strong><p>Note that all CAS-provided settings 
exclusively begin with the prefix <code>cas</code>. Other frameworks and packages upon which CAS
depends may present their own configuration naming scheme. Note the difference.</p></div>

<p>If you wish to design your own and extend the CAS configuration file, you can surely follow 
the same approach with the <code class="language-plaintext highlighter-rouge">@EnableConfigurationProperties</code> annotation or use the good olâ€™ <code class="language-plaintext highlighter-rouge">@Value</code>.</p>

                </div>
            </section>
        </main>
    </div>
</div>


<footer>
    <div class="container">
        CAS is supported by the <a href="https://www.apereo.org/">Apereo Foundation</a>.
    </div>
</footer>

<script>
    let pageSection = 'Configuration';
</script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>

<script src="../../javascripts/URI.js"></script>
<script src="../../javascripts/main.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
</body>

</html>
