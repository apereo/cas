---
layout: default
title: CAS - Google Authenticator Authentication
category: Multifactor Authentication
---

{% include variables.html %}

# Google Authenticator Authentication

Google Authenticator generates 2-step verification codes on your phone. With 2-step 
verification signing in will require a code generated by the 
Google Authenticator app in addition to primary authentication. Learn 
more about the topic [here](https://en.wikipedia.org/wiki/Google_Authenticator).

Note that the functionality presented here should also be compatible with 
the likes of [LastPass Authenticator](https://lastpass.com/auth), etc.

## Configuration

Support is enabled by including the following module in the overlay:

{% include casmodule.html group="org.apereo.cas" module="cas-server-support-gauth" %}

{% include {{ version }}/gauth-configuration.md %}

{% include {{ version }}/mfa-bypass-configuration.md configKey="cas.authn.mfa.gauth" %}

{% include {{ version }}/job-scheduling-configuration.md configKey="cas.authn.mfa.gauth.cleaner" %}

{% include {{ version }}/signing-encryption-configuration.md configKey="cas.authn.mfa.gauth" signingKeySize="512" encryptionKeySize="256" encryptionAlg="AES_128_CBC_HMAC_SHA_256" %}


## Administrative Endpoints

The following endpoints are provided by CAS:
 
| Endpoint                 | Description
|--------------------------|------------------------------------------------
| `gauthCredentialRepository`   | Manage and control [Google Authenticator account records](GoogleAuthenticator-Authentication.html). A `GET` operation produces a list of all account records. A `DELETE` operation will delete all account records. A `GET` operation produces with a parameter selector of `/{username}` will list the record assigned to the user. A `DELETE` operation produces with a parameter selector of `/{username}` will remove the record assigned to the user.

## Token Repository

In order to prevent reuse of tokens issued, CAS will attempt to keep track of 
tokens that are successfully used to authenticate the user.
The repository that holds registration records and tokens is periodically 
scanned and cleaned up so that expired and previously used tokens
may be removed.

## Registration

By default, an account registry implementation is included that collects user 
device registrations and saves them into memory.
Issued tokens are also captured into a self-cleaning cache to prevent token 
reuse for a configurable period of time.
This option should only be used for demo and testing purposes. Production 
deployments of this feature will require a separate
implementation of the registry that is capable to register accounts into persistent storage.

Note that each individual account is allowed to register multiple devices to be 
used later for multifactor authentication. Duration the
authentication flow, the user will be asked to select the appropriate device for 
authentication if multiple device registration records
are found. The ability to handle multiple device registration 
records can be controlled via CAS settings.

### JPA

Please [see this guide](GoogleAuthenticator-Authentication-Registration-JPA.html) for more info.

### CouchDb

Please [see this guide](GoogleAuthenticator-Authentication-Registration-CouchDb.html) for more info.

### MongoDb

Please [see this guide](GoogleAuthenticator-Authentication-Registration-MongoDb.html) for more info.

### Redis

Please [see this guide](GoogleAuthenticator-Authentication-Registration-Redis.html) for more info.

### LDAP

Please [see this guide](GoogleAuthenticator-Authentication-Registration-LDAP.html) for more info.

### REST

Please [see this guide](GoogleAuthenticator-Authentication-Registration-Rest.html) for more info.

### JSON

Please [see this guide](GoogleAuthenticator-Authentication-Registration-JSON.html) for more info.

## REST Protocol Credential Extraction 

In the event that the [CAS REST Protocol](../protocol/REST-Protocol.html) is turned on, a special credential extractor is injected into the REST authentication engine in order to recognize credentials and authenticate them as part of the REST request. 
The expected parameter name in the request body is `gauthotp`. The account identifier may also be passed using the `gauthacct` parameter in the request body.
