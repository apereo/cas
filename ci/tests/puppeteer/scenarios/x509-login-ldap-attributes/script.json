{
  "dependencies": "x509-webflow,ldap,person-directory,scripting",
  "conditions": {
    "docker": "true"
  },
  "properties": [
    "--cas.server.name=https://localhost:8443",
    "--cas.server.prefix=${cas.server.name}/cas",

    "--server.ssl.trust-store=file:${PWD}/ci/tests/puppeteer/scenarios/${SCENARIO}/truststore.jks",
    "--server.ssl.trust-store-password=changeit",
    "--server.ssl.key-store-type=PKCS12",
    "--server.ssl.client-auth=want",

    "--logging.level.org.apereo.services.persondir=info",
    "--logging.level.org.apereo.cas.persondir=info",

    "--cas.person-directory.active-attribute-repository-ids=ADAUTH,COMMONATTRS",

    "--cas.authn.x509.principal.active-attribute-repository-ids=ADCERT,COMMONATTRS",
    "--cas.authn.x509.reg-ex-trusted-issuer-dn-pattern=.*",
    "--cas.authn.x509.max-path-length-allow-unspecified=true",
    "--cas.authn.x509.principal-type=RFC822_EMAIL",
    "--cas.authn.x509.principal.principal-attribute=x509Rfc822Email,subjectDn",
    "--cas.authn.x509.subject-alt-name.alternate-principal-attribute=subjectDn",
    
    "--cas.authn.attribute-repository.core.merger=MULTIVALUED",
    "--cas.authn.attribute-repository.core.default-attributes-to-release=someattribute,anotherattribute,ldap-dn,uid,user-account-control,x509Rfc822Email,x509subjectUPN",

    "--cas.authn.ldap[0].base-dn=dc=cas,dc=example,dc=org",
    "--cas.authn.ldap[0].bind-credential=M3110nM3110n#1",
    "--cas.authn.ldap[0].bind-dn=Administrator@cas.example.org",
    "--cas.authn.ldap[0].ldap-url=ldap://localhost:10390",
    "--cas.authn.ldap[0].max-pool-size=5",
    "--cas.authn.ldap[0].min-pool-size=0",
    "--cas.authn.ldap[0].subtree-search=true",
    "--cas.authn.ldap[0].type=AUTHENTICATED",
    "--cas.authn.ldap[0].search-filter=(sAMAccountName={user})",
    "--cas.authn.ldap[0].use-start-tls=false",
    "--cas.authn.ldap[0].trust-store=JKS",
    "--cas.authn.ldap[0].trust-store-password=changeit",
    "--cas.authn.ldap[0].trust-store-type=JKS",
    "--cas.authn.ldap[0].hostname-verifier=ANY",

    "--cas.authn.attribute-repository.ldap[0].id=ADAUTH",
    "--cas.authn.attribute-repository.ldap[0].order=0",
    "--cas.authn.attribute-repository.ldap[0].attributes.sAMAccountName=uid",
    "--cas.authn.attribute-repository.ldap[0].attributes.userAccountControl=user-account-control",
    "--cas.authn.attribute-repository.ldap[0].attributes.distinguishedName=ldap-dn",
    "--cas.authn.attribute-repository.ldap[0].bind-dn=Administrator@cas.example.org",
    "--cas.authn.attribute-repository.ldap[0].bind-credential=M3110nM3110n#1",
    "--cas.authn.attribute-repository.ldap[0].ldap-url=ldap://localhost:10390",
    "--cas.authn.attribute-repository.ldap[0].use-start-tls=false",
    "--cas.authn.attribute-repository.ldap[0].subtree-search=true",
    "--cas.authn.attribute-repository.ldap[0].base-dn=dc=cas,dc=example,dc=org",
    "--cas.authn.attribute-repository.ldap[0].follow-referrals=false",
    "--cas.authn.attribute-repository.ldap[0].search-filter=(sAMAccountName={username})",
    "--cas.authn.attribute-repository.ldap[0].min-pool-size=0",
    "--cas.authn.attribute-repository.ldap[0].trust-store=file:${#systemProperties['java.io.tmpdir']}/adcacerts.jks",
    "--cas.authn.attribute-repository.ldap[0].trust-store-type=JKS",
    "--cas.authn.attribute-repository.ldap[0].trust-store-password=changeit",
    "--cas.authn.attribute-repository.ldap[0].hostname-verifier=ANY",

    "--cas.authn.attribute-repository.ldap[1].id=ADCERT",
    "--cas.authn.attribute-repository.ldap[1].order=1",
    "--cas.authn.attribute-repository.ldap[1].attributes.sAMAccountName=uid",
    "--cas.authn.attribute-repository.ldap[1].attributes.userAccountControl=user-account-control",
    "--cas.authn.attribute-repository.ldap[1].attributes.distinguishedName=ldap-dn",
    "--cas.authn.attribute-repository.ldap[1].bind-dn=Administrator@cas.example.org",
    "--cas.authn.attribute-repository.ldap[1].bind-credential=M3110nM3110n#1",
    "--cas.authn.attribute-repository.ldap[1].ldap-url=ldap://localhost:10390",
    "--cas.authn.attribute-repository.ldap[1].use-start-tls=false",
    "--cas.authn.attribute-repository.ldap[1].subtree-search=true",
    "--cas.authn.attribute-repository.ldap[1].base-dn=dc=cas,dc=example,dc=org",
    "--cas.authn.attribute-repository.ldap[1].follow-referrals=false",
    "--cas.authn.attribute-repository.ldap[1].search-filter=(mail={x509Rfc822Email})",
    "--cas.authn.attribute-repository.ldap[1].min-pool-size=0",
    "--cas.authn.attribute-repository.ldap[1].trust-store=file:${#systemProperties['java.io.tmpdir']}/adcacerts.jks",
    "--cas.authn.attribute-repository.ldap[1].trust-store-type=JKS",
    "--cas.authn.attribute-repository.ldap[1].trust-store-password=changeit",
    "--cas.authn.attribute-repository.ldap[1].hostname-verifier=ANY",

    "--cas.authn.attribute-repository.groovy[0].id=COMMONATTRS",
    "--cas.authn.attribute-repository.groovy[0].location=file:${PWD}/ci/tests/puppeteer/scenarios/${SCENARIO}/attributes.groovy",
    "--cas.authn.attribute-repository.groovy[0].order=2",
    "--cas.authn.attribute-repository.groovy[0].case-insensitive=false",

    "--cas.authn.attribute-repository.groovy[1].id=NOTUSEDATTRS",
    "--cas.authn.attribute-repository.groovy[1].location=file:${PWD}/ci/tests/puppeteer/scenarios/${SCENARIO}/notusedattributes.groovy",
    "--cas.authn.attribute-repository.groovy[1].order=1",
    "--cas.authn.attribute-repository.groovy[1].case-insensitive=false"

  ],
  "trustStoreCertificateFile": "./ci/tests/puppeteer/scenarios/x509-login-ldap-attributes/cert.pem",
  "trustStorePrivateKeyFile": "./ci/tests/puppeteer/scenarios/x509-login-ldap-attributes/key.pem",
  "initScript": "${PWD}/ci/tests/ldap/run-ad-server.sh"
}
